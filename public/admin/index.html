<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>üì± Warehouse CMS</title>
  
  <!-- PWA Meta Tags -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#3b82f6">
  <meta name="format-detection" content="telephone=no">
  
  <!-- Icons -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="apple-touch-icon" href="/favicon.svg" />
  
  <!-- Critical Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Netlify Identity -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
  <!-- Loading Screen -->
  <div id="loading" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, #3b82f6, #1d4ed8); display: flex; align-items: center; justify-content: center; z-index: 10000; color: white; font-family: Inter, sans-serif;">
    <div style="text-align: center;">
      <div style="width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.3); border-top: 4px solid white; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
      <div style="font-size: 24px; font-weight: 700; margin-bottom: 8px;">üè¢ Warehouse CMS</div>
      <div style="font-size: 16px; opacity: 0.9;">Optimizing for mobile...</div>
    </div>
  </div>

  <!-- Success Toast -->
  <div id="toast" style="position: fixed; top: 20px; left: 16px; right: 16px; background: #10b981; color: white; padding: 16px; border-radius: 12px; display: none; align-items: center; font-weight: 600; z-index: 10001; font-family: Inter, sans-serif;">
    ‚úÖ Mobile CMS optimized successfully!
  </div>

  <style>
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>

  <!-- Netlify CMS -->
  <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"></script>
  
  <script>
    function ForceMobileCMS() {
      this.initializationAttempts = 0;
      this.maxAttempts = 50;
      this.init();
    }
    
    ForceMobileCMS.prototype.init = function() {
      console.log('üöÄ Force Mobile CMS initializing...');
      this.setupAuthentication();
      this.waitForCMSAndApplyStyles();
    };
    
    ForceMobileCMS.prototype.setupAuthentication = function() {
      var self = this;
      if (window.netlifyIdentity) {
        window.netlifyIdentity.on('init', function(user) {
          if (!user) {
            console.log('üîê Waiting for authentication...');
          } else {
            console.log('‚úÖ User authenticated');
          }
        });
        
        window.netlifyIdentity.on('login', function() {
          console.log('üéâ Login successful');
          self.showToast();
        });
        
        window.netlifyIdentity.on('logout', function() {
          window.location.reload();
        });
      }
    };
    
    ForceMobileCMS.prototype.waitForCMSAndApplyStyles = function() {
      var self = this;
      
      function checkAndApply() {
        self.initializationAttempts++;
        
        var cmsContainer = document.querySelector('#nc-root') || 
                          document.querySelector('[class*="nc-app"]') ||
                          document.querySelector('.nc-app-container');
        
        if (cmsContainer) {
          console.log('üì± CMS detected, applying mobile optimizations...');
          self.applyForcedMobileStyles();
          self.hideLoading();
          return;
        }
        
        if (self.initializationAttempts < self.maxAttempts) {
          setTimeout(checkAndApply, 100);
        } else {
          console.warn('‚ö†Ô∏è CMS not detected, applying styles anyway...');
          self.applyForcedMobileStyles();
          self.hideLoading();
        }
      }
      
      checkAndApply();
    };
    
    ForceMobileCMS.prototype.applyForcedMobileStyles = function() {
      console.log('üé® Injecting aggressive mobile styles...');
      
      var mobileStyles = document.createElement('style');
      mobileStyles.id = 'force-mobile-cms';
      
      var cssRules = '';
      
      // CSS Variables
      cssRules += ':root {';
      cssRules += '--mobile-primary: #3b82f6 !important;';
      cssRules += '--mobile-primary-dark: #1d4ed8 !important;';
      cssRules += '--mobile-success: #10b981 !important;';
      cssRules += '--mobile-white: #ffffff !important;';
      cssRules += '--mobile-gray-50: #f9fafb !important;';
      cssRules += '--mobile-gray-100: #f3f4f6 !important;';
      cssRules += '--mobile-gray-200: #e5e7eb !important;';
      cssRules += '--mobile-gray-300: #d1d5db !important;';
      cssRules += '--mobile-gray-400: #9ca3af !important;';
      cssRules += '--mobile-gray-500: #6b7280 !important;';
      cssRules += '--mobile-gray-600: #4b5563 !important;';
      cssRules += '--mobile-gray-700: #374151 !important;';
      cssRules += '--mobile-gray-800: #1f2937 !important;';
      cssRules += '--mobile-gray-900: #111827 !important;';
      cssRules += '--mobile-space-1: 4px !important;';
      cssRules += '--mobile-space-2: 8px !important;';
      cssRules += '--mobile-space-3: 12px !important;';
      cssRules += '--mobile-space-4: 16px !important;';
      cssRules += '--mobile-space-5: 20px !important;';
      cssRules += '--mobile-space-6: 24px !important;';
      cssRules += '--mobile-space-8: 32px !important;';
      cssRules += '--mobile-text-xs: 14px !important;';
      cssRules += '--mobile-text-sm: 16px !important;';
      cssRules += '--mobile-text-base: 18px !important;';
      cssRules += '--mobile-text-lg: 20px !important;';
      cssRules += '--mobile-text-xl: 24px !important;';
      cssRules += '--mobile-text-2xl: 32px !important;';
      cssRules += '--mobile-touch-target: 52px !important;';
      cssRules += '--mobile-radius: 12px !important;';
      cssRules += '--mobile-radius-lg: 16px !important;';
      cssRules += '}';
      
      // Mobile Media Query
      cssRules += '@media screen and (max-width: 768px) {';
      
      // Hide desktop navigation
      cssRules += 'html body div#nc-root div nav,';
      cssRules += 'html body div#nc-root div aside,';
      cssRules += 'html body div#nc-root div [role="navigation"],';
      cssRules += 'html body div#nc-root div [data-testid="sidebar"],';
      cssRules += 'html body div#nc-root div .css-1dbjc4n:first-child,';
      cssRules += 'html body div#nc-root div > div:first-child:not(#nc-root),';
      cssRules += 'html body .nc-app-container nav,';
      cssRules += 'html body .nc-app-container aside,';
      cssRules += 'html body .nc-app-container [role="navigation"],';
      cssRules += 'html body .nc-app-container [data-testid="sidebar"],';
      cssRules += 'html body .nc-app-container .css-1dbjc4n:first-child,';
      cssRules += 'html body .nc-app-container > div:first-child:not(#nc-root) {';
      cssRules += 'display: none !important;';
      cssRules += 'visibility: hidden !important;';
      cssRules += 'opacity: 0 !important;';
      cssRules += 'position: absolute !important;';
      cssRules += 'left: -9999px !important;';
      cssRules += 'width: 0 !important;';
      cssRules += 'height: 0 !important;';
      cssRules += 'overflow: hidden !important;';
      cssRules += 'z-index: -1 !important;';
      cssRules += '}';
      
      // Force full width layout
      cssRules += 'html body div#nc-root,';
      cssRules += 'html body div#nc-root > div,';
      cssRules += 'html body div#nc-root > div > div,';
      cssRules += 'html body div#nc-root main,';
      cssRules += 'html body div#nc-root [role="main"],';
      cssRules += 'html body .nc-app-container,';
      cssRules += 'html body .nc-app-container > div,';
      cssRules += 'html body .nc-app-container > div > div,';
      cssRules += 'html body .nc-app-container main,';
      cssRules += 'html body .nc-app-container [role="main"],';
      cssRules += 'html body .nc-app-container .css-1rr4qq7 {';
      cssRules += 'margin: 0 !important;';
      cssRules += 'margin-left: 0 !important;';
      cssRules += 'margin-right: 0 !important;';
      cssRules += 'padding: var(--mobile-space-4) !important;';
      cssRules += 'width: 100% !important;';
      cssRules += 'max-width: 100% !important;';
      cssRules += 'min-width: 100% !important;';
      cssRules += 'box-sizing: border-box !important;';
      cssRules += 'position: static !important;';
      cssRules += 'transform: none !important;';
      cssRules += 'left: auto !important;';
      cssRules += 'right: auto !important;';
      cssRules += '}';
      
      // Mobile typography
      cssRules += 'html body #nc-root h1,';
      cssRules += 'html body .nc-app-container h1 {';
      cssRules += 'font-size: var(--mobile-text-2xl) !important;';
      cssRules += 'font-weight: 700 !important;';
      cssRules += 'color: var(--mobile-gray-900) !important;';
      cssRules += 'margin: var(--mobile-space-6) 0 !important;';
      cssRules += 'padding: var(--mobile-space-4) 0 !important;';
      cssRules += 'line-height: 1.2 !important;';
      cssRules += 'font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif !important;';
      cssRules += '}';
      
      cssRules += 'html body #nc-root h2,';
      cssRules += 'html body .nc-app-container h2 {';
      cssRules += 'font-size: var(--mobile-text-xl) !important;';
      cssRules += 'font-weight: 600 !important;';
      cssRules += 'color: var(--mobile-gray-800) !important;';
      cssRules += 'margin: var(--mobile-space-5) 0 var(--mobile-space-3) 0 !important;';
      cssRules += 'line-height: 1.3 !important;';
      cssRules += 'font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif !important;';
      cssRules += '}';
      
      // Mobile form elements
      cssRules += 'html body #nc-root input,';
      cssRules += 'html body #nc-root textarea,';
      cssRules += 'html body #nc-root select,';
      cssRules += 'html body .nc-app-container input,';
      cssRules += 'html body .nc-app-container textarea,';
      cssRules += 'html body .nc-app-container select {';
      cssRules += 'min-height: var(--mobile-touch-target) !important;';
      cssRules += 'font-size: var(--mobile-text-base) !important;';
      cssRules += 'font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif !important;';
      cssRules += 'border: 2px solid var(--mobile-gray-300) !important;';
      cssRules += 'border-radius: var(--mobile-radius) !important;';
      cssRules += 'padding: var(--mobile-space-4) var(--mobile-space-5) !important;';
      cssRules += 'background: var(--mobile-white) !important;';
      cssRules += 'color: var(--mobile-gray-900) !important;';
      cssRules += 'width: 100% !important;';
      cssRules += 'margin-bottom: var(--mobile-space-4) !important;';
      cssRules += 'box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;';
      cssRules += 'transition: all 0.2s ease !important;';
      cssRules += 'box-sizing: border-box !important;';
      cssRules += '}';
      
      cssRules += 'html body #nc-root input:focus,';
      cssRules += 'html body #nc-root textarea:focus,';
      cssRules += 'html body #nc-root select:focus,';
      cssRules += 'html body .nc-app-container input:focus,';
      cssRules += 'html body .nc-app-container textarea:focus,';
      cssRules += 'html body .nc-app-container select:focus {';
      cssRules += 'border-color: var(--mobile-primary) !important;';
      cssRules += 'box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1) !important;';
      cssRules += 'outline: none !important;';
      cssRules += 'transform: none !important;';
      cssRules += '}';
      
      // Mobile buttons
      cssRules += 'html body #nc-root button,';
      cssRules += 'html body .nc-app-container button {';
      cssRules += 'min-height: var(--mobile-touch-target) !important;';
      cssRules += 'font-size: var(--mobile-text-base) !important;';
      cssRules += 'font-weight: 600 !important;';
      cssRules += 'font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif !important;';
      cssRules += 'border-radius: var(--mobile-radius) !important;';
      cssRules += 'padding: var(--mobile-space-4) var(--mobile-space-6) !important;';
      cssRules += 'margin: var(--mobile-space-2) var(--mobile-space-1) !important;';
      cssRules += 'transition: all 0.2s ease !important;';
      cssRules += 'cursor: pointer !important;';
      cssRules += 'display: inline-flex !important;';
      cssRules += 'align-items: center !important;';
      cssRules += 'justify-content: center !important;';
      cssRules += 'white-space: nowrap !important;';
      cssRules += 'box-sizing: border-box !important;';
      cssRules += '}';
      
      // Primary buttons
      cssRules += 'html body #nc-root button[color="primary"],';
      cssRules += 'html body #nc-root button[type="submit"],';
      cssRules += 'html body .nc-app-container button[color="primary"],';
      cssRules += 'html body .nc-app-container button[type="submit"] {';
      cssRules += 'background: var(--mobile-primary) !important;';
      cssRules += 'color: var(--mobile-white) !important;';
      cssRules += 'border: none !important;';
      cssRules += 'box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;';
      cssRules += '}';
      
      // Secondary buttons
      cssRules += 'html body #nc-root button:not([color="primary"]):not([type="submit"]),';
      cssRules += 'html body .nc-app-container button:not([color="primary"]):not([type="submit"]) {';
      cssRules += 'background: var(--mobile-white) !important;';
      cssRules += 'color: var(--mobile-gray-700) !important;';
      cssRules += 'border: 2px solid var(--mobile-gray-300) !important;';
      cssRules += '}';
      
      // Mobile lists
      cssRules += 'html body #nc-root ul,';
      cssRules += 'html body #nc-root ol,';
      cssRules += 'html body .nc-app-container ul,';
      cssRules += 'html body .nc-app-container ol {';
      cssRules += 'padding: 0 !important;';
      cssRules += 'margin: var(--mobile-space-4) 0 !important;';
      cssRules += 'list-style: none !important;';
      cssRules += '}';
      
      cssRules += 'html body #nc-root li,';
      cssRules += 'html body .nc-app-container li {';
      cssRules += 'background: var(--mobile-white) !important;';
      cssRules += 'border: 1px solid var(--mobile-gray-200) !important;';
      cssRules += 'border-radius: var(--mobile-radius) !important;';
      cssRules += 'padding: var(--mobile-space-5) !important;';
      cssRules += 'margin-bottom: var(--mobile-space-3) !important;';
      cssRules += 'box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;';
      cssRules += 'transition: all 0.2s ease !important;';
      cssRules += 'cursor: pointer !important;';
      cssRules += '}';
      
      // Mobile labels
      cssRules += 'html body #nc-root label,';
      cssRules += 'html body .nc-app-container label {';
      cssRules += 'font-size: var(--mobile-text-base) !important;';
      cssRules += 'font-weight: 600 !important;';
      cssRules += 'color: var(--mobile-gray-700) !important;';
      cssRules += 'margin-bottom: var(--mobile-space-2) !important;';
      cssRules += 'display: block !important;';
      cssRules += 'line-height: 1.4 !important;';
      cssRules += 'font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif !important;';
      cssRules += '}';
      
      // Force font family everywhere
      cssRules += 'html body #nc-root,';
      cssRules += 'html body #nc-root *,';
      cssRules += 'html body .nc-app-container,';
      cssRules += 'html body .nc-app-container * {';
      cssRules += 'font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif !important;';
      cssRules += '}';
      
      // Prevent zoom
      cssRules += 'html body * {';
      cssRules += '-webkit-text-size-adjust: 100% !important;';
      cssRules += '-ms-text-size-adjust: 100% !important;';
      cssRules += 'text-size-adjust: 100% !important;';
      cssRules += '}';
      
      // Smooth scrolling
      cssRules += 'html body {';
      cssRules += '-webkit-overflow-scrolling: touch !important;';
      cssRules += 'overflow-x: hidden !important;';
      cssRules += '}';
      
      // Button active states
      cssRules += 'html body #nc-root button:active,';
      cssRules += 'html body .nc-app-container button:active {';
      cssRules += 'transform: scale(0.98) !important;';
      cssRules += '}';
      
      // Close media query
      cssRules += '}';
      
      mobileStyles.innerHTML = cssRules;
      document.head.appendChild(mobileStyles);
      
      document.body.style.fontFamily = '"Inter", -apple-system, BlinkMacSystemFont, sans-serif';
      document.body.style.overflow = 'hidden auto';
      
      console.log('‚úÖ Mobile styles injected successfully!');
      this.monitorAndReapply();
    };
    
    ForceMobileCMS.prototype.monitorAndReapply = function() {
      var self = this;
      var reapplyCount = 0;
      var maxReapplies = 5;
      
      var reapplyInterval = setInterval(function() {
        reapplyCount++;
        console.log('üîÑ Re-checking mobile styles (' + reapplyCount + '/' + maxReapplies + ')...');
        
        var existingStyles = document.getElementById('force-mobile-cms');
        if (!existingStyles) {
          console.log('‚ö†Ô∏è Mobile styles were removed, re-applying...');
          self.applyForcedMobileStyles();
        }
        
        if (reapplyCount >= maxReapplies) {
          clearInterval(reapplyInterval);
          console.log('‚úÖ Mobile style monitoring complete');
        }
      }, 2000);
    };
    
    ForceMobileCMS.prototype.hideLoading = function() {
      setTimeout(function() {
        var loading = document.getElementById('loading');
        if (loading) {
          loading.style.opacity = '0';
          loading.style.pointerEvents = 'none';
          setTimeout(function() {
            loading.style.display = 'none';
          }, 500);
        }
      }, 1000);
    };
    
    ForceMobileCMS.prototype.showToast = function() {
      setTimeout(function() {
        var toast = document.getElementById('toast');
        if (toast) {
          toast.style.display = 'flex';
          setTimeout(function() {
            toast.style.display = 'none';
          }, 4000);
        }
      }, 2000);
    };
    
    // Initialize
    var mobileCMS = new ForceMobileCMS();
    
    // Backup initialization
    window.addEventListener('load', function() {
      setTimeout(function() {
        if (!document.getElementById('force-mobile-cms')) {
          console.log('üîÑ Backup: Re-initializing mobile CMS...');
          new ForceMobileCMS();
        }
      }, 1000);
    });
  </script>
</body>
</html>