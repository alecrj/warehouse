---
// Standardized Contact Form Component
// Props to customize the form based on context
interface Props {
  source: string;
  title?: string;
  description?: string;
  warehouseProperty?: string;
  className?: string;
  showWarehouseSelect?: boolean;
  warehouses?: Array<{title: string, slug: string}>;
}

const { 
  source, 
  title = "Get Matched With Warehouses", 
  description = "Tell us what you need and we'll send qualified options.",
  warehouseProperty = "",
  className = "",
  showWarehouseSelect = true,
  warehouses = []
} = Astro.props;

// Get all warehouses for the dropdown if not provided
let allWarehouses = warehouses;
if (showWarehouseSelect && allWarehouses.length === 0) {
  try {
    const { getCollection } = await import('astro:content');
    const warehouseCollection = await getCollection('warehouses');
    allWarehouses = warehouseCollection
      .filter(w => w.data.availability === 'available')
      .map(w => ({ title: w.data.title, slug: w.data.slug }));
  } catch (error) {
    console.log('Could not load warehouses for dropdown');
  }
}
---

<div class={`bg-white rounded-3xl p-8 shadow-lg border border-gray-200 ${className}`}>
  {title && (
    <div class="text-center mb-6">
      <h2 class="text-2xl font-bold text-gray-900 mb-2">{title}</h2>
      {description && <p class="text-gray-600">{description}</p>}
    </div>
  )}
  
  <form 
    name="warehouse-inquiry" 
    method="POST" 
    data-netlify="true" 
    netlify-honeypot="bot-field"
    action="/success"
    class="space-y-6"
  >
    <!-- Hidden fields -->
    <input type="hidden" name="form-name" value="warehouse-inquiry" />
    <input type="hidden" name="source" value={source} />
    {warehouseProperty && <input type="hidden" name="property-interested" value={warehouseProperty} />}
    <div class="hidden">
      <input name="bot-field" />
    </div>

    <!-- Name & Email Row -->
    <div class="grid md:grid-cols-2 gap-4">
      <div>
        <label for="name" class="block text-sm font-semibold text-gray-700 mb-2">
          Name *
        </label>
        <input 
          type="text" 
          id="name" 
          name="name" 
          required 
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all duration-300"
          placeholder="Your Name"
        />
      </div>

      <div>
        <label for="email" class="block text-sm font-semibold text-gray-700 mb-2">
          Email *
        </label>
        <input 
          type="email" 
          id="email" 
          name="email" 
          required 
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all duration-300"
          placeholder="your@email.com"
        />
      </div>
    </div>

    <!-- Phone & Company Row -->
    <div class="grid md:grid-cols-2 gap-4">
      <div>
        <label for="phone" class="block text-sm font-semibold text-gray-700 mb-2">
          Phone *
        </label>
        <input 
          type="tel" 
          id="phone" 
          name="phone" 
          required
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all duration-300"
          placeholder="(954) 123-4567"
        />
      </div>

      <div>
        <label for="company" class="block text-sm font-semibold text-gray-700 mb-2">
          Company
        </label>
        <input 
          type="text" 
          id="company" 
          name="company" 
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all duration-300"
          placeholder="Company Name"
        />
      </div>
    </div>

    <!-- Warehouse Interested & Size Row -->
    <div class="grid md:grid-cols-2 gap-4">
      {showWarehouseSelect && (
        <div>
          <label for="warehouse-interested" class="block text-sm font-semibold text-gray-700 mb-2">
            Warehouse Interested In *
          </label>
          <select 
            id="warehouse-interested" 
            name="warehouse-interested" 
            required
            class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all duration-300"
          >
            <option value="">Select a warehouse...</option>
            <option value="any">Any Available Warehouse</option>
            {allWarehouses.map(warehouse => (
              <option value={warehouse.slug} selected={warehouseProperty === warehouse.slug}>
                {warehouse.title}
              </option>
            ))}
          </select>
        </div>
      )}

      <div>
        <label for="size-needed" class="block text-sm font-semibold text-gray-700 mb-2">
          Size Needed (SF)
        </label>
        <input 
          type="text" 
          id="size-needed" 
          name="size-needed" 
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all duration-300"
          placeholder="500–500,000+ SF"
        />
      </div>
    </div>

    <!-- Timing -->
    <div>
      <label for="timing" class="block text-sm font-semibold text-gray-700 mb-2">
        Timing
      </label>
      <select 
        id="timing" 
        name="timing" 
        class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all duration-300"
      >
        <option value="">Select timeline...</option>
        <option value="immediate">Immediate (0-30 days)</option>
        <option value="1-3-months">1-3 months</option>
        <option value="3-6-months">3-6 months</option>
        <option value="6-12-months">6-12 months</option>
        <option value="12-months-plus">12+ months</option>
        <option value="just-exploring">Just exploring options</option>
      </select>
    </div>

    <!-- Requirements & Message -->
    <div>
      <label for="requirements" class="block text-sm font-semibold text-gray-700 mb-2">
        Requirements & Message
      </label>
      <textarea 
        id="requirements" 
        name="requirements" 
        rows="4"
        class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all duration-300 resize-vertical"
        placeholder="Tell us about your specific requirements: loading docks, clear height, special features, budget, location preferences, etc."
      ></textarea>
    </div>

    <!-- Submit Button -->
    <button 
      type="submit" 
      class="w-full bg-gradient-to-r from-primary-600 to-primary-700 text-white px-8 py-4 rounded-xl text-lg font-semibold hover:from-primary-700 hover:to-primary-800 hover:shadow-lg hover:-translate-y-0.5 transition-all duration-300 transform focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"
    >
      Get Matched With Warehouses
    </button>

    <p class="text-sm text-gray-500 text-center">
      Free service • Landlords pay our fees • No obligation
    </p>
  </form>
</div>