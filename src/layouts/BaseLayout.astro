---
import '../styles/globals.css';
import { ViewTransitions } from 'astro:transitions';

export interface Props {
  title?: string;
  description?: string;
  ogImage?: string;
}

const { 
  title = 'South Florida Industrial Real Estate | Ariel Realty Group',
  description = 'Free tenant representation for warehouse and industrial properties across Miami-Dade, Broward, and Palm Beach counties. Expert guidance, zero cost to tenants.',
  ogImage = '/og-image.jpg'
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{title}</title>
  <meta name="description" content={description} />
  <link rel="canonical" href={canonicalURL} />
  
  <!-- Preconnect to font source -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content={canonicalURL} />
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:image" content={new URL(ogImage, Astro.url)} />
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:url" content={canonicalURL} />
  <meta property="twitter:title" content={title} />
  <meta property="twitter:description" content={description} />
  <meta property="twitter:image" content={new URL(ogImage, Astro.url)} />
  
  <!-- Additional SEO -->
  <meta name="robots" content="index, follow" />
  <meta name="googlebot" content="index, follow" />
  
  <!-- Schema.org markup -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "RealEstateAgent",
    "name": "Ariel Realty Group",
    "description": "South Florida industrial real estate tenant representation",
    "url": "https://laec.netlify.app",
    "telephone": "(954) 937-9667",
    "areaServed": [
      "Miami-Dade County, FL",
      "Broward County, FL", 
      "Palm Beach County, FL"
    ],
    "serviceType": "Industrial Real Estate Tenant Representation",
    "priceRange": "Free for Tenants"
  }
  </script>
  
  <ViewTransitions />
</head>

<body>
  <!-- Header -->
  <header class="sticky top-0 z-50 bg-white/95 backdrop-blur-sm border-b border-black/5">
    <div class="container container-marketing">
      <div class="flex items-center justify-between py-4">
        <!-- Logo -->
        <a href="/" class="flex items-center space-x-3 text-brand font-semibold text-lg">
          <div class="w-10 h-10 bg-brand rounded-lg flex items-center justify-center">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
            </svg>
          </div>
          <span>Ariel Realty Group</span>
        </a>

        <!-- Desktop Navigation -->
        <nav class="hidden md:flex items-center space-x-8">
          <a href="/properties" class="text-muted hover:text-brand transition-colors">Properties</a>
          <a href="/about" class="text-muted hover:text-brand transition-colors">About</a>
          <a href="/contact" class="text-muted hover:text-brand transition-colors">Contact</a>
          <a href="tel:+19549379667" class="btn btn-primary">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
            </svg>
            (954) 937-9667
          </a>
        </nav>

        <!-- Mobile Menu Button -->
        <button id="mobile-menu-btn" class="md:hidden btn btn-icon" aria-label="Toggle menu">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="md:hidden hidden border-t border-black/5 bg-white">
      <div class="container py-4 space-y-4">
        <a href="/properties" class="block py-2 text-muted hover:text-brand transition-colors">Properties</a>
        <a href="/about" class="block py-2 text-muted hover:text-brand transition-colors">About</a>
        <a href="/contact" class="block py-2 text-muted hover:text-brand transition-colors">Contact</a>
        <a href="tel:+19549379667" class="btn btn-primary w-full">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
          </svg>
          (954) 937-9667
        </a>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main>
    <slot />
  </main>

  <!-- Footer -->
  <footer class="bg-brand text-white">
    <div class="container container-marketing py-16">
      <div class="grid md:grid-cols-4 gap-8">
        <!-- Company Info -->
        <div class="md:col-span-2">
          <div class="flex items-center space-x-3 mb-6">
            <div class="w-10 h-10 bg-white/10 rounded-lg flex items-center justify-center">
              <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
              </svg>
            </div>
            <span class="font-semibold text-lg">Ariel Realty Group</span>
          </div>
          <p class="text-white/80 mb-6 max-w-md">
            South Florida's premier industrial tenant representation firm. Free expert guidance for warehouse and industrial property leasing.
          </p>
          <div class="space-y-2">
            <p class="flex items-center text-white/80">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
              </svg>
              <a href="tel:+19549379667" class="hover:text-white transition-colors">(954) 937-9667</a>
            </p>
            <p class="flex items-center text-white/80">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
              </svg>
              South Florida
            </p>
          </div>
        </div>

        <!-- Services -->
        <div>
          <h3 class="font-semibold mb-4">Services</h3>
          <ul class="space-y-2 text-white/80">
            <li>Tenant Representation</li>
            <li>Market Analysis</li>
            <li>Lease Negotiation</li>
            <li>Property Tours</li>
          </ul>
        </div>

        <!-- Markets -->
        <div>
          <h3 class="font-semibold mb-4">Markets Served</h3>
          <ul class="space-y-2 text-white/80">
            <li>Miami-Dade County</li>
            <li>Broward County</li>
            <li>Palm Beach County</li>
          </ul>
        </div>
      </div>

      <!-- Bottom Bar -->
      <div class="border-t border-white/10 pt-8 mt-8 flex flex-col md:flex-row justify-between items-center">
        <p class="text-white/60 text-sm">
          Â© 2024 Ariel Realty Group. All rights reserved.
        </p>
        <p class="text-white/60 text-sm mt-2 md:mt-0">
          Licensed in Florida
        </p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script>
    // Mobile menu toggle
    document.addEventListener('DOMContentLoaded', () => {
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');
      
      mobileMenuBtn?.addEventListener('click', () => {
        mobileMenu?.classList.toggle('hidden');
      });

      // Reveal on scroll animation
      const revealElements = document.querySelectorAll('.reveal');
      
      const revealObserver = new IntersectionObserver((entries) => {
        entries.forEach((entry, index) => {
          if (entry.isIntersecting) {
            setTimeout(() => {
              entry.target.classList.add('visible');
            }, index * 50); // Stagger effect
            revealObserver.unobserve(entry.target);
          }
        });
      }, {
        threshold: 0.15,
        rootMargin: '0px 0px -50px 0px'
      });

      revealElements.forEach(el => {
        revealObserver.observe(el);
      });

      // Form validation
      const forms = document.querySelectorAll('form');
      forms.forEach(form => {
        form.addEventListener('submit', (e) => {
          const requiredFields = form.querySelectorAll('[required]');
          let isValid = true;
          
          requiredFields.forEach(field => {
            const input = field as HTMLInputElement;
            if (!input.value.trim()) {
              isValid = false;
              input.classList.add('error');
            } else {
              input.classList.remove('error');
              input.classList.add('valid');
            }
          });
          
          if (!isValid) {
            e.preventDefault();
            // Focus first invalid field
            const firstInvalid = form.querySelector('.error') as HTMLElement;
            firstInvalid?.focus();
          }
        });
      });
    });

    // Phone number formatting
    function formatPhoneNumber(input: HTMLInputElement) {
      let value = input.value.replace(/\D/g, '');
      if (value.length >= 6) {
        value = `(${value.slice(0, 3)}) ${value.slice(3, 6)}-${value.slice(6, 10)}`;
      } else if (value.length >= 3) {
        value = `(${value.slice(0, 3)}) ${value.slice(3)}`;
      }
      input.value = value;
    }

    // Apply phone formatting to all phone inputs
    document.addEventListener('DOMContentLoaded', () => {
      const phoneInputs = document.querySelectorAll('input[type="tel"]');
      phoneInputs.forEach(input => {
        input.addEventListener('input', () => formatPhoneNumber(input as HTMLInputElement));
      });
    });
  </script>

  <!-- Production only: Register service worker for /admin -->
  {import.meta.env.PROD && (
    <script>
      if ('serviceWorker' in navigator && window.location.pathname.startsWith('/admin')) {
        navigator.serviceWorker.register('/sw.js');
      }
    </script>
  )}
</body>
</html>